#cloud-config
autoinstall:
  version: 1
  identity:
    hostname: vm
    username: ubuntu
    password: "$6$exDY1mhS4KUYCE/2$zmn9ToZwTKLhCw.b4/b.ZRTIZM30JZ4QrOQ2aOXJ8yk96xpcCof0kxKwuX1kqLG/ygbJ1f8wxED22bTL4F46P0"
    # ubuntu
  ssh:
    install-server: true
    allow-pw: false
  packages:
    - openssh-server
  timezone: "Etc/UTC"
  updates: all
  shutdown: poweroff
  user-data:
    users:
      - name: lab
        homedir: /home/lab
        shell: /bin/bash
        lock_passwd: true
        gecos: lab
        groups: adm, cdrom, dip, lxd, plugdev, sudo
        primary_group: lab
        ssh_import_id:
          - gh:johnko
        sudo: ALL=(ALL) NOPASSWD:ALL
      - name: ubuntu
        homedir: /home/ubuntu
        shell: /bin/bash
        lock_passwd: true
        gecos: ubuntu
        groups: ubuntu
        primary_group: ubuntu
        sudo: false
    package_update: true
    package_upgrade: true
    packages:
      - openssh-server
      - docker.io
      - docker-compose
    ssh_pwauth: false
