#!/usr/bin/env sh

# set layout to bsp (managed), other options are float (unmanaged) or stack (layered fullscreen)
yabai -m config layout bsp

# grid format is <rows>:<cols>:<start-x>:<start-y>:<width>:<height>
# float tall center halfwide for web
yabai -m rule --add app="^(Google Chrome|Keychain Access)$" manage=off grid=99:4:1:0:2:98
# float tall
yabai -m rule --add app="^(Clock|Gmail|System Preferences|System Settings)$" manage=off grid=24:24:5:1:14:22
# float tall wide 16/24 of screen for editing
yabai -m rule --add app="^(Books|GarageBand|GIMP|iMovie|Photos)$" manage=off grid=24:24:4:2:16:20
# float tall wide 18/24 of screen for focus
yabai -m rule --add app="^(Code|Xcode)$" manage=off grid=24:24:3:3:18:21
# float tall wide 20/24 of screen for video
yabai -m rule --add app="^(Crunchyroll.*|Netflix|TV)$" manage=off grid=24:24:2:4:20:19

# float middle center quarter
yabai -m rule --add app="^(1Password|FaceTime|Finder|Photo Booth|QuickTime.*|TextEdit)$" manage=off grid=4:4:1:1:2:2
# float bottom center quarter
yabai -m rule --add app="^(Activity Monitor|App Store|Contacts|Dictionary|Voice Memos)$" manage=off grid=4:4:1:2:2:2
# float bottom center 2/3
yabai -m rule --add app="^(Calendar|Disk Utility|Find My|Home|Maps|News|Shortcuts|Stocks|System Information|Weather)$" manage=off grid=12:12:3:4:6:8

# right half, fulltall
yabai -m rule --add app="^(Console|GitHub|Google Drive|Preview)$" manage=off grid=99:60:30:0:29:98

# top right quarter screen
yabai -m rule --add app="^(LuLu)$" manage=off grid=99:60:30:0:29:49
# bottom left quarter screen
yabai -m rule --add app="^(UTM)$" manage=off grid=99:60:1:49:29:49
# bottom right quarter screen
yabai -m rule --add app="^(Docker.*|Podman.*|Netiquette|Podcasts)$" manage=off grid=99:60:30:49:29:49

# float 1st slot down, quartertall on vertical screen
yabai -m rule --add app="^(Google Calendar|Notes|Reminders)$" manage=off grid=101:60:1:0:58:25
# float top half on vertical screen
yabai -m rule --add app="^(Brave Browser)$" manage=off grid=101:60:1:0:58:50

# float 2nd slot down halfwide middle on vertical screen
yabai -m rule --add app="^(Instagram|Messages|WhatsApp.*)$" manage=off grid=101:60:16:25:29:50
# float 2nd slot down, quartertall halfwide right on vertical screen
yabai -m rule --add app="^(Firefox|Spotify)$" manage=off grid=101:60:30:25:29:25

# float 2nd slot down 3/4tall vertical screen
yabai -m rule --add app="^(Safari|Slack)$" manage=off grid=101:60:1:25:58:75
# float bottom left on vertical screen
yabai -m rule --add app="^(Signal)$" manage=off grid=101:60:1:50:29:50
# float bottom right on vertical screen
yabai -m rule --add app="^(LINE)$" manage=off grid=101:60:30:50:29:50

# float 3rd slot down, quartertall on vertical screen
yabai -m rule --add app="^(Discord)$" manage=off grid=101:60:1:50:58:25

# float 4th slot down, quartertall on vertical screen
yabai -m rule --add app="^(Music)$" manage=off grid=101:60:1:75:58:25

# Terminal specific so can swap - float middle center quarter
# yabai -m rule --add app="^(Terminal)$" manage=off grid=4:4:1:1:2:2
# Terminal specific so can swap - almost fullscreen
# yabai -m rule --add app="^(Terminal)$" manage=off grid=60:60:1:1:58:58
# Terminal specific so can swap - float 2nd slot down 3/4tall vertical screen
yabai -m rule --add app="^(Terminal)$" manage=off grid=101:60:1:25:58:75

# Coding grid
# top left
yabai -m rule --add app="^(Code|Cursor|Terminal)$" title="^.*(6)$" manage=off grid=99:60:1:0:29:49
# top right
yabai -m rule --add app="^(Code|Cursor|Terminal)$" title="^.*(7)$" manage=off grid=99:60:30:0:29:49
# middle center
yabai -m rule --add app="^(Code|Cursor|Terminal)$" title="^.*(0)$" manage=off grid=4:4:1:1:2:2
# bottom left
yabai -m rule --add app="^(Code|Cursor|Terminal)$" title="^.*(8)$" manage=off grid=99:60:1:49:29:49
yabai -m rule --add app="^(Terminal)$" title="^.*(1)$" manage=off grid=99:60:1:49:29:49
# bottom right
yabai -m rule --add app="^(Code|Cursor|Terminal)$" title="^.*(9)$" manage=off grid=99:60:30:49:29:49
# left/right split
yabai -m rule --add app="^(Code|Cursor)$" title="^.*(2|3|4|5)$" manage=off grid=99:60:1:0:29:98
yabai -m rule --add app="^(Terminal)$" title="^.*(2|3|4|5)$" manage=off grid=99:60:30:0:29:98


# float some non-resizable apps
yabai -m rule --add app="^(Archive Utility|Calculator|iPhone Mirroring)$" manage=off

# default to float almost centered
# cat .yabairc | grep -v grep | grep -v '^ *#' | grep app= | cut -d= -f2 | sed -e 's,manage,,' -e 's, title,,g' -e 's, $,,g' | grep -v noexist | tr -d '"^$)(' | tr '|' "\n" | sort -u | tr "\n" '|' | sed -e 's, |,|,g' -e 's,|$,,'
yabai -m rule --add app!="^(1Password|Activity Monitor|App Store|Archive Utility|Books|Brave Browser|Calculator|Calendar|Clock|Code|Console|Contacts|Crunchyroll.*|Cursor|Dictionary|Discord|Disk Utility|Docker.*|FaceTime|Find My|Finder|Firefox|GarageBand|GIMP|GitHub|Gmail|Google Calendar|Google Chrome|Google Drive|Home|iMovie|Instagram|iPhone Mirroring|Keychain Access|LINE|LuLu|Maps|Messages|Music|Netflix|Netiquette|News|Notes|Photo Booth|Photos|Podcasts|Podman.*|Preview|QuickTime.*|Reminders|Safari|Shortcuts|Signal|Slack|Spotify|Stocks|System Information|System Preferences|System Settings|Terminal|TextEdit|TV|UTM|Voice Memos|Weather|WhatsApp.*|Xcode)$" manage=off grid=24:24:4:2:16:20

# apply rules on restart
yabai -m rule --apply
# balance resize windows after rules applied
yabai -m space --balance
